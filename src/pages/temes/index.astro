---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getTagsWithStats, polEmoji, polClass } from "../../lib/data";

const tags = getTagsWithStats();
---

<BaseLayout title="Temes">
  <nav class="breadcrumb" aria-label="breadcrumb">
    <li><a href={import.meta.env.BASE_URL}>Inici</a></li>
    <li>Temes</li>
  </nav>

  <div class="page-header">
    <h1 class="page-header__title">Temes</h1>
    <p class="page-header__subtitle">
      {tags.length} categories tem√†tiques dels punts de l'ordre del dia
    </p>
  </div>

  <div class="grid grid-3">
    {
      tags.map((t) => (
        <a
          href={`${import.meta.env.BASE_URL}temes/${t.code}/`}
          class="card tag-card"
        >
          <div class="tag-card__name">{t.name}</div>
          <div class="tag-card__desc">{t.description}</div>
          <div class="tag-card__meta">
            <span class="badge badge--tag">
              {t.interventionCount} intervencions
            </span>
            {t.avgPolarization > 0 && (
              <span class={`badge ${polClass(Math.round(t.avgPolarization))}`}>
                {polEmoji(Math.round(t.avgPolarization))} Pol.{" "}
                {t.avgPolarization}
              </span>
            )}
          </div>
        </a>
      ))
    }
  </div>
</BaseLayout>

<style>
  .tag-card {
    display: flex;
    flex-direction: column;
    gap: var(--s-sm);
  }
  .tag-card__name {
    font-weight: 700;
    font-size: var(--fs-lg);
  }
  .tag-card__desc {
    font-size: var(--fs-sm);
    color: var(--c-text-muted);
    flex: 1;
  }
  .tag-card__meta {
    display: flex;
    gap: var(--s-xs);
    flex-wrap: wrap;
  }
</style>
